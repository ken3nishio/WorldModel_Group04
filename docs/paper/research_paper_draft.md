# Dynamic Stability: Overcoming Semantic Inertia in World Models via Frequency-Adaptive Hysteresis Control
# 動的安定性：周波数適応型ヒステリシス制御による世界モデルにおける意味的慣性の克服

## Abstract

世界モデル（World Models）の構築において、長期間にわたる物理的一貫性と文脈の維持は不可欠な要件である。近年の「FramePack」などの圧縮コンテキスト技術は、計算効率を保ちながら無限の長尺生成を可能にした。しかし、我々はこれらの強力な記憶メカニズムが、副作用として**「意味的慣性（Semantic Inertia）」**を引き起こすことを特定した。これは、モデルが過去の状態（コンテキスト）に過度に適応し、エージェントの操作や急激な環境変化（シーン遷移、消失など）を「一貫性の欠如」として棄却してしまう現象である。
本研究では、このトレードオフを解消するために **Frequency-Adaptive Hysteresis Control (FAHC)** を提案する。拡散モデルのデノイジングプロセスにおける周波数特性（初期段階で低周波・大構造を決定する性質）に着目し、生成の初期段階において過去コンテキストへの依存度を動的に緩和する制御機構を導入した。
実験の結果、FAHCは長期的な一貫性を維持しつつ、エージェントのアクション追従性（Action Controllability）とシーン遷移の忠実度（Transition Fidelity）を大幅に向上させることを示した。これは、世界モデルが「安定したシミュレータ」であると同時に「操作可能な環境」であることを両立させるための重要なステップである。

---

## 1. Introduction (序論)

### 1.1 背景：世界モデルと長期記憶のジレンマ
自律エージェントの学習環境として機能する「世界モデル」には、相反する2つの能力が求められる。
1.  **Stability (安定性)**: 物理法則やオブジェクトの同一性を長時間維持する能力。
2.  **Plasticity/Controllability (可塑性/操作性)**: エージェントの介入や外部要因によって状態を柔軟に変化させる能力。

### 1.2 問題提起：意味的慣性 (Semantic Inertia)
既存の長尺動画生成モデル（FramePack等）は、Stabilityを最大化するために過去の情報を圧縮・維持する強力なメモリアーキテクチャを採用している。しかし、我々の分析により、この強力なメモリが逆効果となり、以下のような問題を引き起こすことが判明した。
*   **Action Rejection**: エージェントが「右に曲がる」行動を選択しても、モデルが「直進する過去の慣性」を優先し、直進映像を生成し続ける。
*   **Transition Failure**: 「物体が消える」「シーンが変わる」といった不連続な変化を、一貫性のエラー（ドリフト）として処理し、変化を抑制する。

我々はこの現象を**「意味的慣性（Semantic Inertia）」**と定義する。これは、物理学における「慣性（Inertia）」のアナロジーであり、質量（過去の記憶量）が大きいほど、運動状態（生成される映像の内容）の変化には大きな力（プロンプトや条件付け）が必要となる現象である。

### 1.3 提案手法：FAHC
本研究では、拡散モデルの生成プロセス内部に介入し、この「慣性」を動的に制御する手法 **Frequency-Adaptive Hysteresis Control (FAHC)** を提案する。これは、デノイジングステップ（時間 $t$）に応じて、Classifier-Free Guidance (CFG) の適用強度と参照コンテキストの影響度を動的に変調させるものである。

---

## 2. Related Work (関連研究)

*   **Long-Context Video Generation**: FramePack, StreamingT2Vなどのメモリ圧縮・管理技術。これらは「忘却を防ぐ」ことに主眼を置いており、「意図的な忘却」には触れていない。
*   **Controllable Video Generation**: ControlNetやT2V-Adapterなどの空間的制御。これらは構造的な制御には強いが、長文脈における「文脈的制御（Semantic Control）」とは異なる。
*   **Diffusion Frequency Analysis**: 拡散モデルが初期ステップで低周波成分（大域構造）を、後半で高周波成分（詳細）を生成するという知見（ALG等）。本研究はこの特性を制御に応用する。

---

## 3. Method (提案手法)

### 3.1 FramePackにおける慣性のメカニズム
FramePackのメモリ $M_t$ は、過去のフレーム $f_{0:t-1}$ を圧縮して保持する。
$$ x_t \sim P(x_t | M_t, c_{prompt}) $$
ここで $M_t$ が保持する情報量（エントロピー）が $c_{prompt}$ （プロンプトやアクション）よりも支配的である場合、生成分布 $P(x_t)$ は過去の分布 $P(x_{t-1})$ に強く拘束される。特に、低周波成分（物体の存在、背景の構造）は圧縮後も強く残存するため、変化に対する抵抗となる。

### 3.2 Frequency-Adaptive Hysteresis Control (FAHC)
我々は、デノイジング過程のノイズレベル $\sigma$ （$1 \to 0$）に応じて、ガイダンススケール $w$ を動的に変調する関数を導入する。

$$ w(\sigma) = w_{base} + \beta \cdot (w_{inject} - w_{base}) \cdot \phi(\sigma) $$

ここで、
*   $w_{base}$: 通常のCFGスケール（一貫性維持用）。
*   $w_{inject}$: アクション注入用のCFGスケール（変化促進用）。
*   $\beta$: 制御係数（ヒステリシス係数）。アクションの強さや変化の要求度に応じて調整可能。
*   $\phi(\sigma)$: 周波数応答関数。初期段階（$\sigma \approx 1$、低周波決定期）で最大化し、終盤で0に収束する。

具体的には、今回実装した **Step-Adaptive CFG** がこの具現化である：
$$ \text{cfg}(\sigma) = \text{cfg}_{min} + (\text{cfg}_{base} - \text{cfg}_{min}) \times (1 - \beta \times \sigma) $$

### 3.3 理論的解釈：ヒステリシスの打破
この制御は、システムに**「ヒステリシス（履歴効果）」を一時的にキャンセルする窓**を開けることに等しい。
*   **初期フェーズ（High $\sigma$）**: 過去の記憶（履歴）への拘束を弱め、新しいプロンプ入力（アクション）に基づいて大域的な構造（Global Structure）を再定義する。
*   **終盤フェーズ（Low $\sigma$）**: 過去の記憶との整合性を回復し、テクスチャレベルでの一貫性を高める。

これにより、「構造的な変化」は許容しつつ、「視覚的な品質」は維持するという、相反する要件を時間軸（Denosing Step）上で分離して解決する。

---

## 4. Experiments (実験計画)

### 4.1 評価タスク
世界モデルとしての性能を評価するため、以下の3つのタスクを設定する。
1.  **The "Disappearance" Task (消失タスク)**: "A man walking" から "The man disappears" への遷移。
    *   評価：物体検出による不在確認率。
2.  **The "Sudden Turn" Task (急転換タスク)**: 直進から急な右折・左折。
    *   評価：オプティカルフローによる動作方向の整合性。
3.  **Long-Term Consistency (長期一貫性)**: 変化を指示しない場合の品質維持。
    *   評価：FVD, Object Consistency Score。

### 4.2 期待される結果（仮説）
*   従来手法（Fixed CFG）では、消失タスクにおいて高い確率で「ゴースト」が残る（Semantic Inertiaの影響）。
*   提案手法（FAHC）は、$\beta$ を適切に設定することで、一貫性スコアを大きく損なうことなく、消失・転換タスクの成功率を有意に向上させる。

---

## 5. Discussion (議論)

### 5.1 世界モデルにおける「選択的忘却」
本研究は、世界モデルにおいて「記憶すること」と同じくらい「適切に忘れること」が重要であることを示唆している。FAHCは、デノイジングプロセス自体を一種のゲートキーパーとして機能させ、過去の情報のうち「現在のコンテキストに適合しない低周波情報」を選択的にフィルタリングする効果を持つといえる。

### 5.2 エージェント学習への影響
強化学習エージェントにとって、環境からのフィードバック（自分のアクションが世界を変えたという実感）は学習の基盤である。FAHCにより、エージェントの試行錯誤が環境に即座に反映されるようになれば、世界モデル内での強化学習効率が飛躍的に向上する可能性がある。

---

## 6. Conclusion (結論)

本研究では、長尺世界モデルにおける「意味的慣性」の問題を指摘し、それを解決するための「FAHC」を提案した。これは単なる動画生成のテクニックにとどまらず、**「操作可能で、かつ一貫性のあるデジタル世界」**を構築するための基盤技術である。
